<!DOCTYPE html>
<html lang="en">
    <head>
        <title>About</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="./styles.css">
    </head>

    <body>
    <!--Navigation Bar-->
    <section id="navigation-bar">
        <div class="container">
            <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
              <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
                <svg class="bi me-2" width="40" height="32"><use xlink:href="#bootstrap"></use></svg>
                <span class="fs-4"><strong>Hatttrick</strong></span>
              </a>
        
              <ul class="nav nav-pills">
                <li class="nav-item"><a href="#" class="nav-link active" aria-current="page">Home</a></li>
                <li class="nav-item"><a href="./leagues.html" class="nav-link">Leagues</a></li>
                <li class="nav-item"><a href="./clubs.html" class="nav-link">Clubs</a></li>
                <li class="nav-item"><a href="./players.html" class="nav-link">Players</a></li>
                <li class="nav-item"><a href="./about.html" class="nav-link">About</a></li>
              </ul>
            </header>
          </div>
    </section>
    
    </body>

    <footer>
        <small>Copyright Â© 2024. Hatttrick. All Rights Reserved.</small>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

<!-- JavaScript for fetching and displaying GitLab data -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Define the URLs for the GitLab API requests
        const commitsUrl = "https://gitlab.com/api/v4/projects/59212893/repository/commits";
        const issuesUrl = "https://gitlab.com/api/v4/projects/59212893/issues";
        const headers = {
            "PRIVATE-TOKEN": "glpat-TaBkMeTCfWtJXpf6mDKx"
        };

        // Function to fetch data from GitLab API
        function fetchData(url) {
            return fetch(url, { headers })
                .then(response => response.json())
                .catch(error => console.error('Error fetching data:', error));
        }

        // Function to create and display member cards
        function createMemberCards(members) {
            const membersContainer = document.getElementById('members');
            for (const [name, data] of Object.entries(members)) {
                const memberCard = document.createElement('div');
                memberCard.className = 'col-lg-4 col-md-6 mb-4';

                memberCard.innerHTML = `
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">${name}</h5>
                            <p class="card-text">Issues: ${data.issues}</p>
                            <p class="card-text">Commits: ${data.commits}</p>
                        </div>
                    </div>
                `;
                membersContainer.appendChild(memberCard);
            }
        }

        // Process fetched data and prepare members' data
        Promise.all([fetchData(commitsUrl), fetchData(issuesUrl)])
            .then(([commitsData, issuesData]) => {
                let members = {};
                commitsData.forEach(commit => {
                    let committerName = commit.committer_name;
                    if(committerName=="ang3lCerda"){
                        committerName="Angel Cerda"
                    }
                    if (!members[committerName]) {
                        members[committerName] = { issues: 0, commits: 0 };
                    }
                    members[committerName].commits++;
                });

                issuesData.forEach(issue => {
                    let authorName = issue.author.name;
                    if (!members[authorName]) {
                        members[authorName] = { issues: 0, commits: 0 };
                    }
                    members[authorName].issues++;
                });

                createMemberCards(members);
            });
    });
</script>

</body>
</html>
